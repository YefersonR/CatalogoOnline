<div>
    <div class="row">
        <div class="add">
            <a href="/User/Register" class="btn btn-success ">Agregar </a>
        </div>
        <div class="col-4 mb-3">
            <div class="card shadow-sm">
                <a style="text-decoration:none; color:gray;">
                    <div class="card-body" id="Card">

                    </div>
                </a>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">×</button>
                <h4 class="modal-title" id="myModalLabel">Edit User</h4>
            </div>
            <div class="modal-body">
                <form class="formContent" id="formValidate">
                    <input id="ID" name="ID" type="hidden" />

                    <div class="field">
                        <input id="FirstName" name="FirstName" placeholder="Enter your name" />
                    </div>
                    <div class="field">
                        <input id="LastName" name="LastName" placeholder="Enter your last name" />
                    </div>
                    <div class="field">
                        <input id="PhoneNumber" name="PhoneNumber" placeholder="Enter your phone number" />
                    </div>
                    <div class="field">
                        <input type="email" id="Email" name="Email" placeholder="Enter your email" />
                    </div>
                    <div class="field">
                        <input id="Address" name="Address" placeholder="Enter your address" />
                    </div>
                    <div class="field">
                        <input id="UserName" name="UserName" placeholder="Enter your username" />
                    </div>
                    <div class="field">
                        <input type="password" id="UserPassword" name="UserPassword" placeholder="Enter your password" />
                    </div>
                    <div class="field">
                        <select id="IsActive" class="form-select">
                            <option value=false>Disactive</option>
                            <option value=true>Active</option>
                        </select>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnAdd" onclick="Update();">Update</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script>
            window.onload = () => {
                var url = "/User/List"
                $.ajax({
                    url: url,
                    method: "GET",
                    dataType: "json",
                    contentType: "application/json",
                    success: function (data) {
                        data = JSON.parse(data);
                        console.log(data)
                        $.map(data, (user) => {
                            $("#Card").append(
                                "<div class='CardContainer'>" +
                                "<h3>" + user.FirstName + "</h3>" +
                                "<h4>" + user.UserName + "</h4>" +
                                "<div class='d-flex justify-content-between'>" +
                                "<p class='card-text'> " + user.Email + "</p>" +
                                "<p class='card-text'> " + user.Address + "</p>" +
                                "<p class='card-text'>" + user.PhoneNumber + "</p>" +
                                "<p class='card-text'>" + user.IsActive + "</p>" +
                                "<small class='fw-bold'></small>"+
                                 "<div class='btn-group'>" +
                                "<button type='button' class='btn btn-primary' data-toggle='modal' data-target='#myModal' onclick='getbyID(" + user.ID + ")'>Edit</button>" +
                                "<a class='btn btn-danger' onclick='Delete(" + user.ID + ")'>Borrar</a>" +
                                "</div>"
                                )
                        })

                    },
                    error: function (err) {
                        console.error(err);
                    }
                })
            }
            function Delete(ID) {
                var user = {
                    "ID": ID
                }
                $.post('/User/Delete', user)
                    .done(function (data) {
                        if (data != null) {
                            window.location.href = "/Home/Index"
                        }
                    })
                    .fail(function (data) {
                        console.log(data)
                    })
            }
            function getbyID(ID) {
                $.ajax({
                    url: "/User/GetID",
                    method: "GET",
                    dataType: "json",
                    contentType: "application/json",
                    data: {
                        "ID": ID
                    },
                    success: function (data) {
                        data = JSON.parse(data);
                        $('#ID').val(data.ID);
                        $('#FirstName').val(data.FirstName);
                        $('#LastName').val(data.LastName);
                        $('#PhoneNumber').val(data.PhoneNumber);
                        $('#Email').val(data.Email);
                        $('#Address').val(data.Address);
                        $('#UserName').val(data.UserName);
                        $('#UserPassword').val(data.UserPassword);
                        $('#IsActive').val(data.IsActive);

                    },
                    error: function (err) {
                        console.error(err);
                    }
                })
            }

            function Update() {
                var productModel = {
                    "ID": $('#ID').val(),
                    "FirstName": $('#FirstName').val(),
                    "LastName": $('#LastName').val(),
                    "PhoneNumber": $('#PhoneNumber').val(),
                    "Email": $('#Email').val(),
                    "Address": $('#Address').val(),
                    "UserName": $('#UserName').val(),
                    "UserPassword": $('#UserPassword').val(),
                    "IsActive": $('#IsActive').val()


                }
                console.log(productModel)
                $.post('/User/Update', productModel)
                    .done(function (data) {
                        if (data != null) {
                            window.location.href = data
                        }
                    })
            }


</script>
